# _api/rooms/[id]/
> L2 | 父级: /_api/rooms/CLAUDE.md

## 成员清单

join.ts: 加入聊天室端点，用户加入指定聊天室，更新成员列表
leave.ts: 离开聊天室端点，用户离开聊天室，清理成员数据
messages.ts: 聊天室消息端点，获取聊天室消息列表、发送消息
users.ts: 聊天室用户端点，获取聊天室成员列表、在线状态

### 子目录模块
messages/ - 消息操作端点，删除消息、编辑消息、标记已读

## 依赖关系
- 依赖 Redis 存储聊天室数据
- 依赖 Pusher 实时通知
- 依赖 _utils/auth 认证验证
- 被前端聊天应用调用

## 聊天室操作约束
1. 加入聊天室必须验证权限（公开/私有）
2. 离开聊天室时清理成员列表和在线状态
3. 消息发送必须广播到所有在线成员
4. 消息列表支持分页，每页 50 条
5. 成员列表包含用户名、头像、在线状态
6. 删除消息必须是消息发送者或管理员
7. 编辑消息必须标记编辑时间

[PROTOCOL]: 变更时更新此头部，然后检查 CLAUDE.md
